% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/read.summary.stats.r
\name{read.summary.stats}
\alias{read.summary.stats}
\title{Extract summary statistics from a VCF file (multi-sample support)}
\usage{
read.summary.stats(vcf.file, fields = c("ES", "SE", "LP"), regions = NULL)
}
\arguments{
\item{vcf.file}{Path to a bgzipped VCF file (.vcf.gz). Must be indexed with tabix (.tbi).}

\item{fields}{Character vector of FORMAT fields to extract (e.g., \code{c("ES", "SE", "LP")}).}

\item{regions}{Optional character vector of genomic regions to extract, in the format \code{"chr:start-end"}.}
}
\value{
A \code{data.frame} with standard VCF columns and one column per sample Ã— field (e.g., \code{S1_ES}, \code{S2_ES}).
}
\description{
This function reads a bgzipped VCF file (.vcf.gz) and extracts selected fields from the FORMAT column
for each sample. The result is returned as a structured data frame with one column per (sample, field)
combination (e.g., \code{S1_AF}, \code{S2_AF}, etc.).
}
\details{
Standard VCF fields (CHROM, POS, ID, REF, ALT, QUAL, FILTER) are included as common columns.
FORMAT fields such as \code{ES}, \code{SE}, \code{LP}, \code{AF}, etc. are extracted for each sample.
Fields that are declared as strings (e.g., \code{ID}) are returned as \code{character}, others as numeric.

Optionally, parsing can be restricted to specific genomic regions using tabix-style regions 
(e.g., \code{"1:700000-1100000"}).
}
\examples{
# Example using real summary statistics VCF
vcf_file <- "inst/extdata/ebi-a-GCST001198.vcf.gz"
fields <- c("ES", "SE", "LP", "ID")
df <- read.summary.stats(vcf_file, fields, regions = c("1:700000-1100000"))
head(df)

# Example using a VCF file with two samples
vcf_file <- "inst/extdata/two_samples.vcf.gz"
fields <- c("AF", "ES", "EZ", "ID", "LP", "NC", "SE", "SI", "SS")
df <- read.summary.stats(vcf_file, fields)
head(df)

}
