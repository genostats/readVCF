% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mk.dosage.file.r
\name{mk.dosage.file}
\alias{mk.dosage.file}
\title{Convert VCF to file-backed dosage matrix}
\usage{
mk.dosage.file(vcf.file, dosage.file, regions)
}
\arguments{
\item{vcf.file}{A character string specifying the path to the input VCF file (gzipped and tabix-indexed recommended).}

\item{dosage.file}{A string prefix for output files (will generate `dosage.dosf`, `.bim`, `.fam`, `.dosf.desc`).}

\item{regions}{An optional character vector of genomic regions to extract (e.g., `"19:320000-700000"`). If omitted, the full file is read.}
}
\value{
This function is called for its side effects. It returns `invisible(NULL)`.
}
\description{
Converts genotype data from a VCF file into a file-backed matrix (dosages), and generates associated `.bim` and `.fam` files.
This enables interoperability with tools, and allows access via the `bigmemory` package.
}
\details{
This function performs the following:
\itemize{
  \item Extracts genotype dosage values (typically from the `"DS"` FORMAT field).
  \item Stores them in a `.dosf` file as a binary float matrix.
  \item Creates a `.bim` file containing SNP metadata (e.g., ID, CHR, POS, A1, A2).
  \item Creates a `.fam` file with sample information (family ID, individual ID, father ID, mother ID, sex, phenotype).
  \item Writes a `.desc` file to allow attaching the `.dosf` file via [bigmemory::attach.big.matrix()].
}
Files that already exist are not overwritten.
}
\examples{
# Create a temporary directory for output
outprefix <- tempfile()

# Path to example VCF included in the package
filename <- system.file("extdata", "example.vcf.gz", package = "readVCF")

# Create dosage matrix + .bim, .fam, .desc files
mk.dosage.file(filename, outprefix, regions = "19:320000-330000")

# Attach the dosage matrix (float values)
library(bigmemory)
dosage_matrix <- attach.big.matrix(paste0(outprefix, ".dosf.desc"))

# Display its dimensions and a small subset
print(dim(dosage_matrix))
print(dosage_matrix[1:min(5, nrow(dosage_matrix)), 1:min(5, ncol(dosage_matrix))])

}
\seealso{
\link[bigmemory]{attach.big.matrix}, \link{mk.descriptor.file}
}
